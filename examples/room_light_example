#!/usr/bin/env ruby

require "hue_conference"

hue = Ruhue.discover

client = Ruhue::Client.new(hue, "substantial")

if client.registered?
  puts "It appears your already registered with the Hub. Play away!"
elsif client.register("ruhue")
  puts "A new application has been registered with the Hub as #{client.username}. Play away!"
end

manifest = HueConference::LightManifest.new(client)
manifest.build_manifest

my_light = manifest.lights.select do |light|
  light.name == 'Test Lamp 1'
end.first

my_light.sync!

require 'pry'; binding.pry
loop do
  sleep(1)
  my_light.toggle
end

